<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <!-- Bootstrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body { background: #f8f9fa; }
      .dashboard-section { margin-bottom: 1.5rem; }
    </style>
</head>
<body>
    <!-- ìƒë‹¨ ì œëª© í‘œì‹œ -->
    <nav class="navbar navbar-dark bg-dark mb-4">
        <a class="navbar-brand ms-3" href="#">ì¤‘í•™ìƒì´ ë§Œë“œëŠ” ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ ğŸš€</a>
    </nav>

    <div class="container-fluid">

        <!-- ğŸ˜Š 1. ì¹´ë“œ(ì¹´ìš´íŠ¸ ì •ë³´, ë©”ì„¸ì§€)-->
        <div class="row dashboard-section">
            <div class="col-sm-3">
                <div class="card bg-primary text-white text-center mb-2">
                    <div class="card-body">
                        <h5 class="card-title">ì´ ìœ ì € ìˆ˜</h5>
                        <h2>{{ users_count }}</h2>
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="card bg-warning text-dark text-center mb-2">
                    <div class="card-body">
                        <h5 class="card-title">ìƒˆ ë©”ì„¸ì§€</h5>
                        <h2>{{ new_msg_count }}</h2>
                    </div>
                </div>
            </div>
            <!-- ì›í•˜ëŠ” ë§Œí¼ ì¹´ë“œ ì¶”ê°€ ê°€ëŠ¥ -->
            <div class="col-sm-6">
                <div class="card bg-light text-center mb-2">
                    <div class="card-body">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/3/38/MathSymbolPi.svg" alt="dashboard" height="32">
                        <span class="ms-3">ëŒ€ì‹œë³´ë“œì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤.</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ğŸ’¡ 2. ì•Œë¦¼(ê³µì§€/ê²½ê³ /ì„±ê³µ ë“±) -->
        <div class="dashboard-section">
            {% for n in notifications %}
                <div class="alert alert-{{ n.type }} alert-dismissible fade show" role="alert">
                  {{ n.msg }}
                  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        </div>

        <!-- ğŸ“Š 3. ì°¨íŠ¸  (ì°¨íŠ¸ëŠ” 2ì¤„ì— ë‚˜ëˆ ì„œ ë°°ì¹˜) -->
        <div class="row dashboard-section">
            <div class="col-md-6 mb-4">
                <div class="card h-100">
                    <div class="card-header"> ì¼ê°„ ë§¤ì¶œ ì¶”ì´ (Line) </div>
                    <div class="card-body">
                        <canvas id="lineChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card h-100">
                    <div class="card-header"> ì ‘ì†ê¸°ê¸° ë¹„ìœ¨ (Doughnut) </div>
                    <div class="card-body">
                        <canvas id="pieChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card h-100">
                    <div class="card-header"> íšŒì› ë“±ê¸‰ ë¶„í¬ (Bar) </div>
                    <div class="card-body">
                        <canvas id="barChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div class="row dashboard-section">
            <div class="col-md-6 mb-4">
                <div class="card h-100">
                    <div class="card-header"> ê³¼ëª©ë³„ ì„±ì  (Radar) </div>
                    <div class="card-body">
                        <canvas id="radarChart"></canvas>
                    </div>
                </div>
            </div>
            <!-- ì›í•˜ëŠ” ì°¨íŠ¸ ì¶”ê°€ ê°€ëŠ¥ -->
        </div>

        <!-- ğŸ“ 4. ìµœê·¼ ë“±ë¡ ìœ ì € í…Œì´ë¸” -->
        <div class="row dashboard-section">
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">ìµœê·¼ ê°€ì…í•œ ìœ ì €</div>
                    <div class="card-body p-0">
                        <table class="table mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th>ì´ë¦„</th>
                                    <th>ì´ë©”ì¼</th>
                                    <th>ê°€ì…ì¼</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for user in recent_users %}
                                    <tr>
                                        <td>{{ user.name }}</td>
                                        <td>{{ user.email }}</td>
                                        <td>{{ user.date }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- ì°¨íŠ¸ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {

            // 1. ì¼ê°„ ë§¤ì¶œ(ë¼ì¸ ì°¨íŠ¸)
            var ctxLine = document.getElementById('lineChart').getContext('2d');
            new Chart(ctxLine, {
                type: 'line',
                data: {
                    labels: {{ sales_labels | safe }},
                    datasets: [{
                        label: 'ë§¤ì¶œ(ë§Œì›)',
                        data: {{ sales_data | safe }},
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 2,
                        tension: 0.4,
                        pointRadius: 4,
                        fill: true
                    }]
                },
                options: { responsive: true }
            });

            // 2. ì ‘ì†ê¸°ê¸°(ë„ë„› ì°¨íŠ¸)
            var ctxPie = document.getElementById('pieChart').getContext('2d');
            new Chart(ctxPie, {
                type: 'doughnut',
                data: {
                    labels: {{ pie_labels | safe }},
                    datasets: [{
                        data: {{ pie_data | safe }},
                        backgroundColor: ['#36A2EB', '#FFCE56', '#FF6384']
                    }]
                },
                options: { responsive: true }
            });

            // 3. ë“±ê¸‰ë³„ íšŒì›(ë°” ì°¨íŠ¸)
            var ctxBar = document.getElementById('barChart').getContext('2d');
            new Chart(ctxBar, {
                type: 'bar',
                data: {
                    labels: {{ bar_labels | safe }},
                    datasets: [{
                        label: 'íšŒì› ìˆ˜',
                        data: {{ bar_data | safe }},
                        backgroundColor: [
                            'rgba(54,162,235,0.8)', 'rgba(255,99,132,0.8)', 'rgba(255,206,86,0.8)', 'rgba(75,192,192,0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });

            // 4. ì„±ì (ë ˆì´ë” ì°¨íŠ¸)
            var ctxRadar = document.getElementById('radarChart').getContext('2d');
            new Chart(ctxRadar, {
                type: 'radar',
                data: {
                    labels: {{ radar_labels | safe }},
                    datasets: [{
                        label: 'ë‚˜ì˜ ì ìˆ˜',
                        data: {{ radar_data | safe }},
                        backgroundColor: 'rgba(255,99,132,0.2)',
                        borderColor: 'rgba(255,99,132,1)',
                        borderWidth: 2,
                        fill: true
                    }]
                },
                options: { responsive: true }
            });
        });
    </script>

    <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© JS (ì•Œë¦¼ ë‹«ê¸°ìš©) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
